expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank())
p0
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2; kappa = 0.5
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(intensity1 = case_when(
t >= rest_time[2] & t <= rest_time[3] ~ intensity*kappa^1,
t >= rest_time[4]  ~ intensity*kappa^2,
TRUE ~ intensity*kappa^0))
# plot
p1 = ggplot() +
geom_line(data = INTENS[INTENS$t <= rest_time[1],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[2]&INTENS$t <= rest_time[3],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[4],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS,
aes(x = t, y = intensity), alpha = 0.3, size = 0.8)+
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank())
p1
ggsave("figs/NHPP_intensity.pdf", p1, width = 10, height = 6.18)
pacman::p_load(ggplot2, dplyr)
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(type = ifelse(((t >= rest_time[1] & t <= rest_time[2])|(t >= rest_time[3] & t <= rest_time[4])), 0.2, 1))
# plot
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.02, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank())
p0
ggsave("figs/PLP_NHPP_intensity.pdf", p0, width = 10, height = 6.18)
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2; kappa = 0.5
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(intensity1 = case_when(
t >= rest_time[2] & t <= rest_time[3] ~ intensity*kappa^1,
t >= rest_time[4]  ~ intensity*kappa^2,
TRUE ~ intensity*kappa^0))
# plot
p1 = ggplot() +
geom_line(data = INTENS[INTENS$t <= rest_time[1],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[2]&INTENS$t <= rest_time[3],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[4],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS,
aes(x = t, y = intensity), alpha = 0.3, size = 0.8)+
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank())
p1
ggsave("figs/PLP_jump_point_intensity.pdf", p1, width = 10, height = 6.18)
pacman::p_load(ggplot2, dplyr)
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(type = ifelse(((t >= rest_time[1] & t <= rest_time[2])|(t >= rest_time[3] & t <= rest_time[4])), 0.2, 1))
# plot
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank())
p0
ggsave("figs/PLP_NHPP_intensity.pdf", p0, width = 10, height = 6.18)
pacman::p_load(ggplot2, dplyr)
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(type = ifelse(((t >= rest_time[1] & t <= rest_time[2])|(t >= rest_time[3] & t <= rest_time[4])), 0.2, 1))
# plot
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank())
p0
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()
p0
# plot
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank())
p0
ggsave("figs/PLP_NHPP_intensity.pdf", p0, width = 10, height = 6.18)
```
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.01, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank())
p0
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.005, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank())
p0
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank())
p0
plp = function(t, beta = 2, theta = 10) return(beta*theta^(-beta)*t^(beta-1))
sim_plp_tau = function(tau = 30,
beta = 2,
theta = 10){
# initialization
s = 0; t = 0
while (max(t) <= tau) {
u <- runif(1)
s <- s - log(u)
t_new <- theta*s^(1/beta)
t <- c(t, t_new)
}
t = t[c(-1, -length(t))]
return(t)
}
pacman::p_load(ggplot2, dplyr)
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(type = ifelse(((t >= rest_time[1] & t <= rest_time[2])|(t >= rest_time[3] & t <= rest_time[4])), 0.2, 1))
# plot
p0 = ggplot() +
geom_line(data = INTENS, aes(x = t, y = intensity), size = 0.8) +
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank())
p0
ggsave("figs/PLP_NHPP_intensity.pdf", p0, width = 10, height = 6.18)
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2; kappa = 0.5
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(intensity1 = case_when(
t >= rest_time[2] & t <= rest_time[3] ~ intensity*kappa^1,
t >= rest_time[4]  ~ intensity*kappa^2,
TRUE ~ intensity*kappa^0))
# plot
p1 = ggplot() +
geom_line(data = INTENS[INTENS$t <= rest_time[1],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[2]&INTENS$t <= rest_time[3],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[4],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS,
aes(x = t, y = intensity), alpha = 0.3, size = 0.8)+
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank())#panel.border = element_blank()
p1
ggsave("figs/PLP_jump_point_intensity.pdf", p1, width = 10, height = 6.18)
set.seed(223)
tau0 = 13; beta0 = 1.2; theta0 = 2; kappa = 0.8
# SCE time
t_SCE = sim_plp_tau(tau = tau0, beta = beta0, theta = theta0)
shift_id= rep(0, length(t_SCE))
SCE = data.frame(shift_id, t_SCE)
# Rest
rest_time = c(4, 5, 8.2, 9.2)
REST1 = data.frame(xaxis = c(rest_time[1:2], rev(rest_time[1:2])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
REST2 = data.frame(xaxis = c(rest_time[3:4], rev(rest_time[3:4])),
yaxis = rep(c(0,max(INTENS$intensity)), each = 2))
# Intensity and limit
INTENS = data.frame(t = seq(0, tau0, 0.001),
intensity = plp(seq(0, tau0, 0.001), beta0, theta0)) %>%
mutate(intensity1 = case_when(
t >= rest_time[2] & t <= rest_time[3] ~ intensity*kappa^1,
t >= rest_time[4]  ~ intensity*kappa^2,
TRUE ~ intensity*kappa^0))
# plot
p1 = ggplot() +
geom_line(data = INTENS[INTENS$t <= rest_time[1],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[2]&INTENS$t <= rest_time[3],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS[INTENS$t >= rest_time[4],],
aes(x = t, y = intensity1), size = 0.8) +
geom_line(data = INTENS,
aes(x = t, y = intensity), alpha = 0.3, size = 0.8)+
geom_point(data = SCE, aes(x = t_SCE, y = shift_id),
alpha = 1, shape = 4, color = 'red', size = 2, stroke = 1.5) +
geom_segment(data = LIM,
aes(x = start_time, xend = end_time, y = shift_id, yend = shift_id),
arrow = arrow(length = unit(0.2, "cm")), lineend = 'butt', size = 0.8) +
scale_x_continuous(expand = c(0.001, 0))+
scale_y_continuous(labels = c(0, max_int), breaks = c(0, max_int),
expand = c(0.02, 0)) +
geom_polygon(data = REST1, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
geom_polygon(data = REST2, aes(xaxis, yaxis),
fill="green", alpha = 0.2) +
labs(x = unname(latex2exp::TeX('Time to SCEs (hours), $t_1$ - $t_n$')),
y = "intensity") +
geom_text(aes(x = c(4.5, 8.7), y = rep(max_int/2, 2),
label = c("rest 1","rest 2"))) +
theme_bw()+
theme(panel.grid = element_blank())#panel.border = element_blank()
p1
ggsave("figs/PLP_jump_point_intensity.pdf", p1, width = 10, height = 6.18)
NDS uses
> **unobtrusive** devices, sensors, and cameras installed on vehicles to **proactively** collect frequent naturalistic driving behavior and performance data under **real-world driving** conditions [@hickman2018synthetic; @guo2019statistical]
### Bayesian hierarchical NHPP with PLP intensity function
I assume that the times of critical events within the $d$-th driver's $s$-th shift were generated from a PLP, with a fixed shape parameter $\beta$ and varying scale parameters $\theta_{d, s}$ across drivers $d$ and shifts $s$. In a PLP, the intensity function of the NHPP is $\lambda(t) = \frac{\beta}{\theta}(\frac{t}{\theta})^{\beta-1}$. The model is described in Equation \@ref(eq:nhpp).
\begin{equation}
\begin{aligned}
T_{d, s, 1}, T_{d, s, 2}, \cdots , T_{d, s, n_{d, s}} & \sim \text{PLP}(\beta, \theta_{d, s})\\
\beta & \sim \text{Gamma}(1, 1)\\
\log\theta_{d, s} &= \gamma_{0d} + \gamma_{1}x_{d, s, 1} + \gamma_{2}x_{d, s, 2} + \cdots + \gamma_{k}x_{d, s, k}\\
\gamma_{01}, \gamma_{02}, \cdots, \gamma_{0D} & \sim \text{i.i.d. }N(\mu_0, \sigma_0^2)\\
\gamma_1, \gamma_2, \cdots, \gamma_k & \sim \text{i.i.d. }N(0, 10^2)\\
\mu_0 &\sim N(0, 10^2) \\
\sigma_0 &\sim \text{Gamma}(1, 1)
(\#eq:nhpp)
\end{aligned}
\end{equation}
The shape parameter $\beta$ shows the reliability changes of drivers. When $\beta > 1$, the intensity function $\lambda(t)$ is increasing, the reliability of drivers is  decreasing, and SCEs are becoming more frequent; when $\beta < 1$, the intensity function $\lambda(t)$ is decreasing, the reliability of drivers is increasing, and SCEs are becoming less frequent; when $\beta = 1$, the NHPP is simplified as a homogeneous Poisson process with the intensity of $1/\theta$. The $\theta_{d, s}$ is a scale parameter that does not reflect reliability changes.
