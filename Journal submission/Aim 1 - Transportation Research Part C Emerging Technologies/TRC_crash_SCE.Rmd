---
title: |
  | The association between crashes and safety-critical events: 
  | synthesized evidence from crash reports and naturalistic driving data among commercial truck drivers
author:
  - name: Miao Cai
    email: miao.cai@slu.edu
    affiliation: SLU
  - name: Mohammad Ali Alamdar Yazdi
    email: yazdi@jhu.edu
    affiliation: JHU
  - name: \mbox{Amir Mehdizadeh}
    email: azm0127@auburn.edu
    affiliation: AU
  - name: Qiong Hu
    email: qzh0011@auburn.edu
    affiliation: AU
  - name: \mbox{Alexander Vinel}
    email: alexander.vinel@auburn.edu
    affiliation: AU
  - name: \mbox{Karen Davis}
    email: davisk4@miamioh.edu
    affiliation: MUCS
  - name: \mbox{Fadel Megahed}
    email: fmegahed@miamioh.edu
    affiliation: MUFSB
  - name: \mbox{Hong Xian}
    email: hong.xian@slu.edu
    affiliation: SLU
  - name: \mbox{Steven E. Rigdon}
    email: steve.rigdon@slu.edu
    affiliation: SLU
    footnote: Corresponding Author
address:
  - code: SLU
    address: Department of Epidemiology and Biostatistics, Saint Louis University, Saint Louis, MO, 63108, United States
  - code: JHU
    address: Carey Business School, Johns Hopkins University, Baltimore, MD, 21218, United States
  - code: AU
    address: Department of Industrial and Systems Engineering, Auburn University, Auburn, AL, 36849, United States
  - code: MUCS
    address: Department of Computer Science and Software Engineering, Miami University, Oxford, OH, 45056, United States
  - code: MUFSB
    address: Department of Information Systems and Analytics, Miami University, Oxford, OH, 45056, United States
abstract: |
  The past decade has witnessed continuous growth of naturalistic driving studies (NDSs). In NDSs, safety-critical events (SCEs) are commonly used as the outcome since crashes are very rare. However, the association between SCEs and crashes is not consistent in previous studies and has not been verified among commercial truck drivers. Based on routinely collected kinematic data from 31,690 truck drivers in a large commercial trucking company, this paper examines the association between four types of SCEs (headways, hard brakes, collision mitigation, and rolling stability) and crashes, as well as injuries and fatalities. Bayesian negative binomial models were applied to examine this association among drivers in different business units and driver types, as well as all drivers combined. It was found that a unit increase in the number of any type of SCEs per 10,000 miles was associated with 8.4% (95% credible interval CI: 8-8.8%) increase in crashes per mile and 8.7% (95% CI: 4.8%-13.6%) increase in the number of injuries per mile. The increase was different in different types of SCEs: 3.3% (95% CI: 2.6-4%) for headways, 8.1% (95% CI: 7.5-8.7%) for hard brakes, 50.4% (95% CI: 41.4-60%) for rolling stability, and 22.2% (95% CI: 19.8-24.5%) for collision mitigation. The results are consistent when stratified by different business units and driver types. This study provides statistically strong and robust evidence that SCEs are positively associated with crashes and injuries among commercial truck drivers. NDS and kinematic data routinely collected by trucking or insurance companies provide a promising opportunity for future data analytics research. 
keywords: truck, naturalistic driving studies, safety-critical events, crashes, injuries, fatalities
journal: "Transportation Research Part C: Emerging Technologies"
date: "`r Sys.Date()`"
bibliography: mybibfile.bib
csl: TRC.csl
output:
  bookdown::pdf_book:
    base_format: rticles::elsevier_article
    number_sections: true
link-citations: true
linkcolor: blue
urlcolor: red
geometry: "left=2cm,right=2cm,top=2cm,bottom=2cm"
fig_caption: yes
header-includes:
  - \usepackage{soulutf8}
  - \usepackage{color}
  - \usepackage{float}
  - \usepackage{subcaption}
  - \usepackage{booktabs}
  - \usepackage{lscape}
  - \usepackage{setspace}
  - \usepackage{dcolumn}
  - \usepackage[utf8]{inputenc}
  - \usepackage{array}
  - \usepackage{makecell}
  - \usepackage[bottom]{footmisc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache = TRUE, message=FALSE, fig.align = "center")
```

\newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}}
\doublespacing

Introduction
============
According to the World Health Organization (WHO), road injuries were the eighth leading cause of death globally in 2018 [@who2018]. They claimed a total of 1.35 million lives every year worldwide, with 74% of them being men and boys [@who2018]. Among children and young adults aged five to 29 years old, road traffic injuries are the leading cause of death [@world2018global]. Besides life losses, road injuries also cause up to 50 million non-fatal injuries and around 75.5 million disability-adjusted life years [@staton2016road; @world2018global]. Among different types of vehicles on the road, trucks are often associated with catastrophic consequences, which can be attributable to long routes, intensive schedule, massive size and weight, and potentially hazardous cargoes [@hanowski2005driver; @chen2014impacts; @chen2016influence; @zheng2018commercial]. For this reason, truck crash prediction has been a widely studied topic in traffic safety research.

A substantial amount of road crash studies focused on using driver characteristics, traffic, weather, and others to predict the likelihood, frequency, or severity of crashes based on retrospective police report data [@lord2010statistical; @wang2013effect; @savolainen2011statistical; @wang2013effect; @roshandel2015impact]. However, truck crash data used in these studies ultimately trace back to retrospective reports, and therefore are subject to several limitations [@stern2019data]. First, truck crash data reported by drivers and police are post-hoc and therefore subject to recall and information bias. The reports cannot accurately record the information including real-time traffic and weather variables prior to the accidents. Second, truck crash data are extremely sparse compared to non-crashes. @fmcsareport2017 estimated that fatalities associated with large trucks and buses in 2017 were 0.156 per million traveled miles. In this sense, it is difficult to make statistically valid conclusions on the risk factors of crashes [@guo2010near; @theofilatos2018impact]. Third, drivers at fault tend to underreport or not report critical factors such as distraction or cell phone use, in order to avoid associated penalties [@dingus2011estimating; @stern2019data]. For the same purpose, those crashes with no human injuries and little financial losses also tend to be underreported or not reported.

In view of the limitations in truck crashes data, naturalistic driving studies (NDSs) have been proposed to collect high-resolution objective data and enhance traffic safety. NDSs use sensors and devices to proactively and unobtrusively collect high-frequency kinematic and Global Positioning System (GPS) data in a real-world driving setting [@neale2005overview; @guo2013individual; @guo2019statistical]. Compared to traditional truck crash studies that are roadway-based or intersection-based case-control studies, NDS data are vehicle-based and are superior in estimating the rate or risk of events since all non-events are collected. More importantly, NDS has the power of providing precise real-time data on kinematic events, such as acceleration or deceleration based on a pre-specified threshold, which provide the opportunity to investigate the short period prior to crashes or safety events without information bias or reporting bias [@guo2010near].  Since NDS data are typically collected every 30 seconds to 5 minutes, the amount of NDS data are generally very large, which provides both an opportunity and a challenge for data analytics.

The number of NDSs worldwide has been increasing in the past 10 years, for example, the 100-Car NDS [@dingus2006100], the second Strategic Highway Research Program [@guo2019statistical], and the Europeâ€™s UDRIVE NDS [@eenink2014udrive]. These NDSs are sponsored by government departments or research organizations, and the number of participating drivers are typically limited considering the budget of the programs. However, in the recent years, it is noticeable that an increasing number of vehicle and insurance companies have been routinely collecting real-time NDS and kinematic data, which have been applied in safety surveillance, insurance pricing, and performance evaluation fields. If these routinely collected large-scale high-resolution data are sufficiently valuable to give insights into transportation safety, they hold huge potential for follow-up data analytics research.

This study is done in collaboration with a leading freight shipping truck company in the United States. The name of the company cannot be revealed for confidentiality reasons and we will refer to it as Company A hereafter. The company provides transportation, delivery, and logistics services to customers and consumers in North America. We consider three business units (dedicated, intermodal, and final-mile) and three driver types (local, regional, and over-the-road). Drivers in the dedicated business unit serve a single customer with familiar routes, task and work duties. Intermodal drivers work with major rail providers and transport freight container from rail yards to customer locations, which are traditional driving duties. Final-mile drivers receive tasks from their managers every day and make deliveries to customer locations. Regarding driver types, local drivers transport freight within a 200-mile radius and return home the same day, regional drivers move freights in a region that may include surrounding states, and over-the-road drivers pick up and delivery freights throughout the country, and they are required to be on duty for at least two weeks and then rest.

The primary objective of this paper is to investigate the association between crashes and safety-critical events (SCEs) among commercial truck drivers. Detected from dynamic kinematic events, SCEs are special types of accident precursors that have all features of accidents, except that potentially catastrophic outcomes were avoided by last-second evasive maneuvers [@dingus2011estimating; @saleh2013accident]. These SCEs are around 10 to 15 times as frequent as crashes, and past studies suggested that they were indicative of crashes [@guo2010near]. SCEs provide an alternative measure of transportation safety, without having to observe for a prohibitively long time to have a sufficiently large amount of crashes [@guo2019statistical]. However, previous studies that quantify this association are limited in the number of drivers and no studies have examined this relationship among commercial truck drivers.

This paper contributes to the following aspects. First, NDS data from more than 30,000 commercial truck drivers were collected, and the data cover most areas in the United States and are generally representative of the trucking industry. The large sample size can yield statistically significant results and conclusions. Second, four types of SCEs are considered in this study: headways, hard brakes, collision mitigation, and rolling stability. We show that the magnitude of association between crashes and the four types of SCEs are different. Third, since most of the crashes had no human injuries or fatalities, previous studies that have smaller sample size do not have sufficient cases of injury or fatality. As the number of drivers and miles driven is relatively large, the association between injuries, fatalities, and SCEs is examined, which is a more important issue than crashes since most crashes have no human injuries.

Literature review
=================
There has been an increasing number of studies since the 1980s evaluating the association between crashes and surrogate measures, with the general approach being to estimate the conversion factor between the two types of events [@evans1982accident; @evans1983risky; @cooper1984experience; @risser1985behavior; @hyden1987development]. This topic has become a crucial issue as NDS data sets are becoming increasingly available to researchers in the recent decade. The first large-scale NDS was the 100-Car NDS, including 100 drivers in northern Virginia and Washington, D.C., in the United States [@neale2005overview]. The study continuously and naturalistically recorded driving data for 102 participating drivers for one year, resulting in around two million vehicle miles and over 40,000 hours of driving data. Over the study period, 69 crashes, 761 near-crashes, and 8,295 incidents were collected. Based on this 100-Car study, @dingus2006100 found that hard braking events were significantly associated with collisions and near-crashes. Since the number of near-crashes and incidents were significantly larger than crashes, they proposed using near-crashes and incidents as surrogate measures of crashes. 

The rationale for using near-crashes and SCEs as surrogates for crashes is the Heinrich's Triangle, which assumes that less severe events are more frequent than severe events, and the frequency of severe events can diminish as the frequency of less severe events decreases [@guo2019statistical]. The former assumption is commonly seen in most NDSs and is considered to be reasonable [@guo2010near]. The association in the latter assumption can be quantitatively tested based on crash and SCEs data in large-scale NDSs, although the causal mechanism is not clear and hard to prove [@guo2010near]. The validity of SCEs varies significantly from studies to studies, so researchers are advised to be cautious when applying SCEs as the outcome [@guo2019statistical]. If the assumptions of Heinrich's Triangle are met, SCEs can provide insights to crash risk and transportation safety when the number of crashes is limited. However, the crucial question prior to using SCEs as a measure of real crashes is whether they are good surrogates of traffic crashes.

@guo2010near proposed two critical principles for using near-crashes as surrogates for crashes: 1) similar or the same causal mechanisms between crashes, surrogates, and risk factors, 2) a strong association between the frequency of surrogates and crashes. Based on the 100-Car study, they investigated the two principles using a sequential factor analysis, a Poisson regression, and sensitivity analyses. The study concluded that using near-crashes as surrogates for crashes will lead to conservative risk estimates but significantly reduce the variance of estimation. They suggested that using near-crashes as surrogates in small-scale studies will be informative for evaluating the risk of crashes.

@gordon2011analysis conducted a preliminary study to validate surrogates for road-departure crashes by spatially merging road geometry, average traffic, crashes, and NDS data. Bayesian seemingly unrelated Poisson models estimated with weighted least squares were used to examine whether these predictor variables have the same effects on crashes and surrogates. The found that time to edge crossing and lane-departure warning were two useful surrogates for crashes on rural nonfreeway roads, but lane deviation was a poor surrogate for lane-departure crashes.

@simons2012elevated examined whether elevated gravitational-force predicts crashes and near-crashes among 42 newly licensed teenage drivers in Virginia. The study used the Naturalistic Teenage Driving Study that followed the recruited drivers for 18 months. A logistic regression estimated with generalized estimating equations to account for the within-subject correlation among different months was applied. The study found that the rate of elevated gravitational-force events was positively associated with the rate of crashes and near-crashes (odds ratio: 1.07, 95% confidence interval: 1.02-1.12), with an area under curve value of 0.76.

@wu2012crashes proposed a conceptual framework to estimate the crash-to-surrogate ratio $\pi$ and used the 100-Car study to test the framework. The study found that the conditional probability of a crash was increased by a factor of 24 with a lateral acceleration more than 0.7 g, but the probability was decreased by other factors such as the event occurring in daylight and dry pavement. A later study by @wu2013defining developed diagnostic procedures to screen crashes and near misses under NDS settings. The study applied the 100-Car NDS on the proposed framework and identified three conditions to define surrogate events: 1) a maximum lateral acceleration difference of no smaller than 0.4 g, 2) non-intersection related, and 3) maximum lateral acceleration difference no smaller than 0.9 per event or between 0.8 and 0.9 g during night time.

@guo2013individual attempted to identify risk factors of driving at driver's level and predict high-risk drivers based on the 100-Car study. The study used a negative binomial (NB) regression to examine the potential four risk factors of crashes and near-crashes. They used a K-mean clustering algorithm to classify the drivers into high-, moderate-, and low-risk groups based on crash and near-crash rates, and applied two logistic regressions to predict high- or moderate-risk drivers. The results confirmed that critical-incident event rates were significantly associated with individual driving risk. The two logistic regressions achieved area under curve (AUC) values of 0.938 and 0.93. They also highlighted that it was a first-step study and more studies with larger and representative data were needed to confirm the association. A similar study by @wu2014using also used the 100-Car NDS data set. This study used a Bayesian multivariate Poisson log-normal model to simultaneously account for crash frequency and severity. They also found a significant positive association between crashes, near-crashes, and crash-relevant incidents.

@pande2017preliminary used linear referencing to link Global Positioning System (GPS) data with roadway features on 39 segments of Highway 101 in California. NB models and random-effects NB models that account for segment-specific variance were used to investigate the relationship between historic crashes and hard braking events. It was found that the freeway segments with high hard braking rates also had higher long-term crash rates, although the other three explanatory variables, average daily traffic, the presence of horizontal curvature, and auxiliary lanes were not statistically significant. 

@gitelman2018exploring used data collected by in-vehicle data recorders on 3,500 segments of interurban roads in Israel to examine the association between two types of safety-related events (braking and speed alert) and crashes on different road types. NB models were used to account for the over-dispersion in the data, and the covariates included several road infrastructure characteristics. The number of braking events was found to be positively associated with injury crashes on single- and dual-carriageway roads, while the association was not significant on freeways. Counterintuitively, they found that speed alert events were consistently and negatively associated with injury crashes on all road types. They suggested that speed alert events were not a good surrogate for crashes, possibly due to its rough definition.

However, some researchers have been skeptical of NDS. For example, @knipling2015naturalistic challenged the validity of using NDS data and SCEs by arguing that the purpose of traffic safety studies is to identify causes of crash harm, where crash harm is defined as property damage, injury, income lost, and all other consequences of different severities [@zaloshnja2007unit]. However, NDS often use SCEs as surrogates of crashes, but very few or no crashes are involved, let alone human harm. Therefore, it is argued that SCEs are not an appropriate part of the Heinrich's Triangle and researchers generally cannot derive valid quantitative conclusions on causations of harm based on NDS data sets. Another study by @knipling2017threats specifically targeted Hour-of-Service (HOS) rule research, such as @blanco2011impact and @hanowski2008analysis, and relevant policy revisions among commercial truck drivers. He argued that HOS studies with a quasi-experiment design were subject to confounding variables, so these studies are limited in demonstrating a causal relationship between HOS and safety outcomes. The paper also argued that NDS lacked external validity since no large truck NDS had examined the causal link between crashes and SCEs. Lastly, the construct validity was doubted since the relationship between driver fatigue, HOS, and SCEs had not been validated.

```{=latex}
\newcommand{\as}[1]{\renewcommand{\arraystretch}{#1}}

\begin{table}[ht]
\centering
\as{1.5} %vertical padding ------
\setlength\tabcolsep{0.15cm} % horizontal padding | | | |
\small
\caption{Differences between our study and existing literature regarding sample size, driver type, crash surrogates, region, time frame, and statistical models.}
\label{tab:lit}

\begin{tabular}{ 
>{\centering\arraybackslash}m{.07\textwidth}  
>{\centering\arraybackslash}m{.07\textwidth}  
>{\centering\arraybackslash}m{.09\textwidth} 
>{\centering\arraybackslash}m{.23\textwidth}  
>{\centering\arraybackslash}m{.20\textwidth}  
>{\centering\arraybackslash}m{.05\textwidth}  
>{\centering\arraybackslash}m{.18\textwidth} }

\toprule
Authors  & sample size & Driver type & Crash surrogates & Country or region & Time frame & Statistical models \\ 

\midrule

Dingus 2006 & 100 cars  & general & braking, steering, accelerating  & Northern Virginia \& Washington, DC, USA & 1 year     & 95\% confidence limits modeled as a Poisson distribution \\
Guo 2010  & 100 cars & general & near crashes & Northern Virginia \& Washington, DC, USA & 1 year     & sequential factor analysis, Poisson regression  \\
Gorden 2011  & 78 drivers & general & lateral deviation, lane-departure warning, time to edge crossing & Southeastern Michigan, USA & 10 months & seemingly unrelated regression, Poisson regression \\
Simons-Morton 2012 & 42 drivers & newly licensed teenagers & elevated gravitational-force & Virginia & 18 months & logistic regression using generalized estimating equations \\
Wu 2012 & 100 cars & general & lateral and longitudinal acceleration, Event button, Yaw rate, Forward amd rear time-to-collision & Northern Virginia \& Washington, DC, USA & 1 year & logistic regression \\
Guo 2013 & 100 cars & general & critical-incident events & Northern Virginia \& Washington, DC, USA & 1 year & negative binomial regression \\
Wu 2014 & 100 cars & general & safety-related events & Northern Virginia \& Washington, DC, USA & 1 year & Poisson regression \\
Pande 2017 & 33 drivers & general & high magnitude jerks while decelerating & San Luis Obispo, California, USA & 10 days & negative binomial regression \\
Gitelman 2018 & 64 vehicles & general & braking, speed alerts & Israel & 1 year & negative binomial regression \\
\textbf{This paper} & \textbf{31,690 drivers} & \textbf{commercial truck drivers} & \textbf{headways, hard brakes, collision mitigation, rolling stability} & \textbf{National data, USA} & \textbf{1 year} & \textbf{Bayesian negative binomial regression} \\ 
\bottomrule
\end{tabular}%
\end{table}
```


In summary, no consistent conclusion has been reached on the association between the number of crashes and surrogates in NDS [@guo2019statistical]. As shown in Table \@ref(tab:lit) and the above review, there are three gaps in previous NDS studies on the association between crashes and SCEs: 1) the number of drivers involved are limited to 33 to 100, which makes it difficult to reach statistically significant conclusions on crashes, injuries, and fatalities, 2) although two separate NDS data sets : the Drowsy Driver Warning System Field Operation Test and the Naturalistic Truck Driving Study have been sponsored by the Federal Motor Carrier Safety Administration [@hickman2018synthetic], no studies have examined the association between crashes and surrogates using NDS data sets that specifically target commercial truck drivers, 3) since previous NDS data sets are limited in the number of drivers and mileage driven, no studies have examined the association between crashes surrogates and human injuries or fatalities.

Methodology
===========
Data description
----------------
The data used in this study were initially collected by Company A for routine performance monitoring and driver assistance, not for research purpose as was the case in the 100-Car study. From April 1, 2015 to March 31, 2016, Company A installed data acquisition systems (DASs) to their trucks in all three business units. These DASs intermittently collected real-time driving ping data every couple of seconds to around 5 minutes. The collected ping data include the exact date and time of the record (year, month, day, hour, minute, and second), GPS (latitudes and longitudes specific to five decimal places), speed, and drivers' anonymized unique ID. The research team excluded drivers who 1) had less than 100 pings, 2) cannot be matched in driver demographics table, and 3) were identified as obvious outliers regarding the rates of SCEs. In total, $1,494,678,173$ pings collected from 31,690 commercial truck drivers were included in the current study. Geographical distributions of these included pings are shown in the results below.

Apart from the ping data, $480,331$ SCEs from the included drivers were recorded when pre-specified kinematic thresholds were triggered while driving. The collected SCE data include the exact date and time, latitude and longitude (specific to five decimal places), driver, and type of SCEs. This SCEs data included 184,773 headways, 231,101 hard brakes, 55,345 collision mitigation, and 9,112 rolling stability. Non-kinematic definitions of the four types of SCEs are:

- *Headway*: the distance between a lead vehicle and the truck is less than a preset threshold value.
- *Hard brake*: the speed decrease within a unit time is larger than a preset threshold value.
- *Collision mitigation*: an imminent collision with a forward slower moving or standing vehicle or object.
- *Rolling stability*: potential roll-over or loss-of-control situations in various road or weather conditions (dry, wet, snow and ice-covered pavement).

<!--
- headway: https://link.springer.com/book/10.1007%2F978-0-387-44409-3
- Collision mitigation: Provides audible and visual alerts to the driver and applies the brakes when the system determines a collision with forward vehicle is imminent,
- Rolling stability: https://www.bendix.com/media/documents/products_1/acb_1/wingmanadvanced/bw2855bxwingmanadvancedbrochurefinal32411.pdf
-->

A crash data set that included driver ID, state, city, report time, the number fatalities, and the number of injuries, were collected by retrospective reports from Company A. In total, 35,008 crashes, 241 injuries, and 22 fatalities were collected for included drivers in this table. The company also provided a driver demographics table that includes age, gender, race, business units, and driver types associated with the driver ID. All data were de-identified prior to the research team's access. The study protocol was approved by the Institutional Review Board of Saint Louis University.

```{r pingshifttrip, out.width='\\textwidth', fig.cap='Data aggregation from ping data to trips for a sample of a commercial NDS data set.', fig.pos='H'}
knitr::include_graphics("figs/fig_ping_trip_real.pdf")
```

Data aggregation
----------------

Since the original ping data set is gigantic and difficult to interpret regarding the routing, we aggregated them to trips using the approach adopted by @pande2017preliminary.
A trip is defined as a continuous period of driving with no more than 30 minutes' stop. In practice, we sorted the original ping data according to date and time for each driver. Then, if the ping speed data showed that the truck was not moving (the speed of the ping equals zero) for more than 30 minutes, the ping data were separated into two different trips. 

This data aggregation process is demonstrated in Figure \@ref(fig:pingshifttrip), where the $x$-axis shows the date and time of pings, and the $y$-axis presents the speed (in miles per hour, MPH). Each point represented a ping at that date and time, with different colors indicating the real-time speed category. Whenever the truck stopped (the grey points) for at least 30 minutes, the pings were separated into different trips, indicated by the purple arrows in the bottom (Trip 1, Trip 2, $\ldots$, Trip 6). The trip time was then calculated by taking the difference between the trip end time and start time. 

The traveled distance within a trip was approximately calculated in three steps: 1) sort the ping data according to driver, date, and time, 2) compute the distance between each two nearest ping locations for each driver using the haversine method, which assumes a spherical earth and ignores ellipsoidal effects [@sinnott1984virtues], 3) sum up all the distance traveled within a trip for each driver. This algorithm aggregated the original ping data into $18,759,300$ trips, with a total of $2,323,007,042$ miles traveled in $65,706,497$ hours. The median distance of a trip is 2.61 hours and the median number of miles per trip was $77.06$ miles.

Statistical models
------------------
Since the outcome variable (the number of crashes for each driver) is a count variable, which is a strictly non-negative integer, Bayesian negative binomial (NB) models are used in this study. Compared with Poisson model commonly used for modeling count outcomes, NB models can adjust for the variance independently from its mean, which handles potential overdispersion or underdispersion issues in the data. Let $Y_i$ denote outcome variable (crashes, injuries, and fatalities respectively) over a distance of $T_i$ miles for the $i$th driver. We assume that $Y_i$ has a NB distribution with the mean parameter $\mu_i$ and a common auxiliary parameter $\phi$. The corresponding probability mass function of $Y_i$ is parameterized as
$$P(y_i|\mu, \phi) = \binom{y + \phi - 1}{y}\bigg(\frac{\mu}{\mu + \phi}\bigg)^y\bigg(\frac{\phi}{\mu + \phi}\bigg)^\phi, y = 0, 1, 2, \ldots .$$
The mean and variance of $Y_i$ are $E[Y_i] = \mu$ and $V(Y_i) = \mu + \frac{\mu^2}{\phi}$. The inverse of $\phi$ controls the overdispersion, which is scaled by $\mu^2$. By assuming that the number of SCEs per 10,000 miles has a mathematically multiplicative effect on the logarithm of rate of crashes $\mu_i$, we have the following log-linear Bayesian NB regression

$$
\begin{aligned}
Y_i & \sim \text{NB}(T_i\times\mu_i, \; \phi)\\
\log\mu_i & = \beta_0 + \beta_1x_{i1} + \beta_2x_{i2} + \cdots + \beta_Kx_{iK},
\end{aligned}
$$
where $\beta_0$ is the intercept, $\beta_k, \; k = 1, 2, \cdots, K$ is the coefficient of the $k$-th predictor variable $x_k$. We take relatively noninformative priors for $\beta_k$ and $\phi$. Specifically, we assume $\beta_0 , \beta_1, \cdots, \beta_K \sim \text{Normal}(0, 10^2)$ and $\phi \sim \text{Exponential}(1)$. The total miles driven $T_i$ is considered as an offset variable to account for the mileage difference among the included drivers. The predictor variables of interest are the rates of all SCEs (the number of SCEs per 10,000 miles) and the rates of four different types of SCEs, including headways, hard brakes, collision mitigation, and rolling stability. The covariates were average speed, driver's age and gender, business units, and driver types. Business units included dedicated (DED), intermodal (INT), and final-mile (FIM), with DED being the reference group. Driver types included local (LOC), regional (REG), and over-the-road (OTR), with LOC being the reference group.

We applied Hamiltonian Monte Carlo (HMC) to approximate the posterior distributions of all parameters. To make sure the Markov chain Monte Carlo converged, we set 4,000 iterations for each of the four chains, with the first 2,000 being warm-up iterations. The Markov chains were considered as converged when the Gelman-Rubin diagnostic $\hat{R}$ was less than 1.1 for each variable [@gelman1992inference]. The posterior mean and 95% credible intervals (CIs) of the incidence rate ratios, IRRs ($\exp(\beta)$) were reported. The interpretation of the IRRs in this Bayesian NB model is: as the number of SCEs per 10,000 miles increases by one unit, the number of crashes per mile will be multiplied by $\exp(\beta)$ times. 

We used Pareto smoothed importance-sampling leave-one-out (PSIS-LOO) cross-validation (CV) to check the goodness-of-fit of and compare different models [@vehtari2017practical; @vehtari2015pareto]. Instead of exact CV that refits the model with different subsamples, the PSIS-LOO uses fast, efficient, and stable importance sampling weights to approximate leave-one-out CV [@gelfand1992model; @gelfand1996model]. It estimates the expected log predicted density (ELPD), estimate number of parameters, and the LOO Information Criterion (LOOIC) for a new data set. Compared with other statistics such as Widely Applicable Information Criterion (WAIC), Deviance information criterion (DIC), and other variants [@spiegelhalter2002bayesian; @watanabe2010asymptotic], PSIS-LOO is both fast and stable in computing. Apart from PSIS-LOO, we also used posterior predictive checks to examine the prediction accuracy [@gelman2013bayesian]. The interpretation of these goodness-of-fit and model comparison statistics will be explained in the Results.

All data cleaning, statistical modeling, and visualization were performed in the statistical computing environment `R 3.6.0` [@Rcoreteam]. The haversine method distance was computed using the `distHaversine()` function in `geosphere` package [@geospherepackage]. The Bayesian NB model was conducted using the `stan_glm()` function in `rstanarm` package [@rstanarmpackage]. The PSIS-LOO statistics were computed using the `loo()` function in `loo` package [@loopackage]. A sample of the original ping data, full data for Bayesian NB regression models, as well as R code for data aggregation, Bayesian NB regression models, model comparison, and diagnostic statistics can be found in the supplementary materials.


Results
=======
Sample description
------------------
Figure \@ref(fig:pointpattern) below shows the geographical point patterns of active pings that have a speed of more than 0 MPH (Figure \@ref(fig:pointpatternA)) and inactive pings that have a speed of 0 MPH (Figure \@ref(fig:pointpatternB)). Since plotting the original gigantic ping data may overwhelm the entire map, we rounded all latitudes and longitudes to two decimal places, which are approximately as large as normal-size parking lot, and then displayed only locations with more than 50 pings. The red points are the locations with at least 50 actively moving pings and blue dots are the locations with at least 50 stopping pings, with darker colors (dark red and dark blue) indicating higher number of pings. The background grey lines are the major roads in the United States [@usgs] and the solid black lines are state boundaries. The geographical point patterns suggest that most of the trucking transportation is closely matching population density (i.e., is more concentrated along the coasts). The active and inactive pings are generally consistent, but active pings are much more concentrated than inactive pings on the major Midwest major roads.

```{=latex}
\begin{figure}%[htb]
    \centering
    \begin{subfigure}[a]{\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/map_active_grey_50.png}%
        \caption{Active pings}
        \label{fig:pointpatternA}
    \end{subfigure}
    \vskip\baselineskip
    \begin{subfigure}[b]{\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/map_stop_grey_50.png}%
        \caption{Inactive pings}
        \label{fig:pointpatternB}
    \end{subfigure}
    \caption{Geographical point patterns of active and inactive pings in a large commercial NDS data set.}
    \label{fig:pointpattern}
\end{figure}
```

Among all the included 31,690 drivers, 29,296 (91.89%) were male, 1,585 (4.97%) were female, and 1,000 (3.14%) were unspecified. The mean age of the drivers were 44.48 years with a standard deviation of 11.72 years. The range of the ages were from 20 to 82 years. Regarding business units, 16,182 (50.76%) drivers served in the DED unit, in which the drivers work for a single customer and drive on familiar routes. 9,780 (30.68%) drivers were in ITM, where the drivers conduct traditional truck driving duties and transport freight containers from rail yards to local locations. 5,919 (18.57%) drivers were in FIM and made deliveries to customer locations. As for driver types, 13,399 (42.03%) were LOC drivers who transport freight within 200 miles and return home on the same day. 15,729 (49.34%) were REG drivers who move freight within a region or interstate and return home on a weekly or bi-weekly basis. Only 2,753 (8.64%) were OTR drivers who deliver and pick up freight throughout the country, and they are required to be on the road for at least two weeks.

```{r table1, eval=FALSE}
pacman::p_load(summarytools)
d = data.table::fread("data/Aim1_crash_SCE.csv")
d[,freq(gender)] # gender
d[,descr(age)]
d[,freq(bus_unit)]
d[,freq(d_type)]
```


Bayesian NB models for all included drivers
------------------------
Table \@ref(tab:pooled) below shows the estimates of posterior IRRs and their CIs in the Bayesian NB models for all the included drivers. We constructed models for all SCEs combined (Pooled model), four types of SCEs as four variables in one model (Four SCEs), and four SCEs separately in four models (columns 4-7). In the Bayesian setting, parameters are considered as random variables that have probabilistic distributions instead of unknown fixed values, so no P-values are reported here. Instead, we reported 95% posterior credible intervals (CIs), which can be interpreted as there is 0.95 probability that these random parameters are within the fixed CIs given the observed data. All the IRRs of SCEs in the six models were greater than one and none of the associated CIs included one, indicating statistically strong evidence that the rates of SCEs were positively associated with the rates of crashes. One unit increase in the number of any type of SCEs per 10,000 miles was associated with 8.4% (95% CI: 8-8.8%) increase in the number of crashes per mile. Specifically, as the number of headways, hard brakes, rolling stability, and collision mitigation per 10,000 miles increased by one unit, the number of crashes per mile were increased by 3.3% (95% CI: 2.6-4%), 8.1% (95% CI: 7.5-8.7%), 50.4% (95% CI: 41.4-60%), and 22.2% (95% CI: 19.8-24.5%) respectively, controlling for other covariates.

Bayesian NB models stratified by business units and driver types
--------------------------------------------------------------
Since the driving behaviors and routing patterns vary significantly among different business units and driver types, we also conducted Bayesian NB models for drivers in different business units and types, and the results are shown below in Table \@ref(tab:stratified). The posterior IRRs and CIs of four SCEs are consistent with those in Table \@ref(tab:pooled). All four type of SCEs were positively associated with the number of crashes per mile. None of the CIs included one except for headways in the DED-OTR unit. These stratified results indicate strong evidence that SCEs were positively associated with crashes in different business units and driver types. Among the four types of SCEs, rolling stability had the highest IRRs, followed by collision mitigation, hard brake, and headway.

\blandscape
```{r message=FALSE}
pacman::p_load(huxtable, broom, dplyr, stringr)

z = readRDS("fit/a0_pooled_fit.rds")

pad_est = function(x, digits = 3, exponentiate = TRUE){
  if(exponentiate){
    z = round(x, digits)
    z = ifelse(z == 0, "0.000", str_pad(z, digits + 2, "right", "0"))
  }else{
    z = ifelse(x < 0,
             round(x, digits) %>% 
               str_pad(digits + 3, "right", "0"),
             round(x, digits) %>% 
               str_pad(digits + 2, "right", "0") %>% 
               str_pad(digits + 3, "left", ' '))
  }
  return(z)
}

getfit = function(fit, model_name = "model_estimate", digits = 3, exponentiate = TRUE){
  z = tidy(fit, intervals = TRUE, prob = 0.95) %>% 
    {if(exponentiate == TRUE){
      mutate(.,
             estimate = exp(estimate),
             lower = exp(lower),
             upper = exp(upper))
      }else{
        .
      }} %>% 
    mutate(estimate = pad_est(estimate),
           ci = paste0("(", pad_est(lower), ", ", 
                       pad_est(upper), ")")) %>% 
    mutate(zz = paste0(estimate, " ", ci)) %>% 
    select(term, zz) %>% 
    magrittr::set_colnames(c("variables", model_name))
  return(z)
}

getloo = function(fit){
  d = fit$estimates %>% 
    as.data.frame() %>% 
    mutate(Estimate = round(Estimate, 1),
           SE = round(SE, 1)) %>% 
    mutate(values = paste0(Estimate, " (", SE, ")")) %>% 
    select(values)
  return(rbind(length(fit$diagnostics$pareto_k), 
               d))
}

tab_fit = getfit(z[[1]], "Pooled model") %>% 
  full_join(getfit(z[[2]], "Four SCEs")) %>% 
  full_join(getfit(z[[3]], "Headways")) %>% 
  full_join(getfit(z[[4]], "Hard brakes")) %>% 
  full_join(getfit(z[[5]], "Rolling stability")) %>% 
  full_join(getfit(z[[6]], "Collision mitigation")) %>% 
  arrange(match(variables, 
                c("(Intercept)", "sce_N", "sce_HW", "sce_HB", "sce_RS", "sce_CM",
                  "age", "ping_speed", "genderM", "genderU"))) %>% 
  mutate(variables = 
           recode(variables,
                  "sce_N" = "All SCEs",
                  "sce_HW" = "Headways", 
                  "sce_HB" = "Hard brakes", 
                  "sce_RS" = "Rolling stability", 
                  "sce_CM" = "Collision mitigation",
                  "age" = "Age",
                  "ping_speed" = "Mean speed",
                  "genderM" = "Gender: male",
                  "genderU" = "Gender: unknown",
                  "bus_unitJBI00" = "Business unit: ITM", 
                  "bus_unitVAN00" = "Businees unit: FIM", 
                  "d_typeOTR" = "Type: OTR", 
                  "d_typeREG" = "Type: REG", 
                  " Intercept " = "(Intercept)")) %>% 
  add_row(variables = "Fit statistics: ")

tab_loo = data.frame(c("sample size", "elpd_loo", "p_loo", "looic")) %>% 
  cbind(getloo(z[[7]])) %>% 
  cbind(getloo(z[[8]])) %>% 
  cbind(getloo(z[[9]])) %>% 
  cbind(getloo(z[[10]])) %>% 
  cbind(getloo(z[[11]])) %>% 
  cbind(getloo(z[[12]])) %>% 
  magrittr::set_colnames(names(tab_fit))
```

```{r results='asis', eval=FALSE}
capture.output({
  stargazer::stargazer(rbind(tab_fit, tab_loo), 
                       summary=FALSE, rownames=FALSE,
                       align=TRUE, float = TRUE, table.placement = '!htbp',
                       title = "Bayesian NB regressions with the rate of SCEs predicting crashes, non-stratified models",
                       font.size = "small",
                       single.row=FALSE, header=FALSE,
                       notes="The SCEs were measured as the number of events per 10,000 miles driven. IRRs and associated 95\\% credible intervals were reported.",
                       label="tab:pooled")
  }) %>% 
  gsub("\\begin{tabular}","\\resizebox{0.8\\paperheight}{!}{\\begin{tabular}", ., fixed=T) %>% 
  gsub("\\end{tabular}","\\end{tabular}}", ., fixed=T) %>% 
  cat()
```

```{=latex}
 \begin{table}[!htbp] \centering    \caption{Bayesian NB regressions with the rate of SCEs predicting crashes, non-stratified models}    \label{tab:pooled}  \small  \resizebox{0.8\paperheight}{!}{\begin{tabular}{@{\extracolsep{5pt}} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} }  \\[-1.8ex]\hline  \hline \\[-1.8ex]  \multicolumn{1}{c}{variables} & \multicolumn{1}{c}{Pooled model} & \multicolumn{1}{c}{Four SCEs} & \multicolumn{1}{c}{Headways} & \multicolumn{1}{c}{Hard brakes} & \multicolumn{1}{c}{Rolling stability} & \multicolumn{1}{c}{Collision mitigation} \\  \hline \\[-1.8ex]  \multicolumn{1}{c}{(Intercept)} & \multicolumn{1}{c}{0.054 (0.047, 0.062)} & \multicolumn{1}{c}{0.048 (0.042, 0.054)} & \multicolumn{1}{c}{0.090 (0.079, 0.103)} & \multicolumn{1}{c}{0.057 (0.050, 0.066)} & \multicolumn{1}{c}{0.082 (0.072, 0.093)} & \multicolumn{1}{c}{0.073 (0.064, 0.083)} \\  \multicolumn{1}{c}{All SCEs} & \multicolumn{1}{c}{1.084 (1.080, 1.088)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{Headways} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.033 (1.026, 1.040)} & \multicolumn{1}{c}{1.077 (1.069, 1.085)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{Hard brakes} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.081 (1.075, 1.087)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.109 (1.102, 1.116)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{Rolling stability} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.504 (1.414, 1.600)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{2.147 (2.015, 2.295)} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{Collision mitigation} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.222 (1.198, 1.245)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.343 (1.316, 1.369)} \\  \multicolumn{1}{c}{Age} & \multicolumn{1}{c}{0.992 (0.990, 0.993)} & \multicolumn{1}{c}{0.992 (0.991, 0.993)} & \multicolumn{1}{c}{0.989 (0.988, 0.990)} & \multicolumn{1}{c}{0.991 (0.989, 0.992)} & \multicolumn{1}{c}{0.989 (0.988, 0.991)} & \multicolumn{1}{c}{0.990 (0.988, 0.991)} \\  \multicolumn{1}{c}{Mean speed} & \multicolumn{1}{c}{0.979 (0.976, 0.982)} & \multicolumn{1}{c}{0.982 (0.979, 0.985)} & \multicolumn{1}{c}{0.971 (0.968, 0.973)} & \multicolumn{1}{c}{0.980 (0.977, 0.983)} & \multicolumn{1}{c}{0.973 (0.970, 0.976)} & \multicolumn{1}{c}{0.975 (0.973, 0.978)} \\  \multicolumn{1}{c}{Gender: male} & \multicolumn{1}{c}{0.817 (0.756, 0.886)} & \multicolumn{1}{c}{0.808 (0.754, 0.867)} & \multicolumn{1}{c}{0.848 (0.785, 0.919)} & \multicolumn{1}{c}{0.823 (0.762, 0.887)} & \multicolumn{1}{c}{0.845 (0.787, 0.909)} & \multicolumn{1}{c}{0.826 (0.770, 0.891)} \\  \multicolumn{1}{c}{Gender: unknown} & \multicolumn{1}{c}{0.975 (0.785, 1.199)} & \multicolumn{1}{c}{0.954 (0.777, 1.149)} & \multicolumn{1}{c}{1.097 (0.896, 1.347)} & \multicolumn{1}{c}{1.096 (0.884, 1.349)} & \multicolumn{1}{c}{1.018 (0.842, 1.239)} & \multicolumn{1}{c}{1.058 (0.870, 1.299)} \\  \multicolumn{1}{c}{Business unit: ITM} & \multicolumn{1}{c}{0.698 (0.670, 0.727)} & \multicolumn{1}{c}{0.717 (0.690, 0.745)} & \multicolumn{1}{c}{0.706 (0.679, 0.735)} & \multicolumn{1}{c}{0.701 (0.672, 0.730)} & \multicolumn{1}{c}{0.735 (0.706, 0.765)} & \multicolumn{1}{c}{0.729 (0.700, 0.758)} \\  \multicolumn{1}{c}{Businees unit: FIM} & \multicolumn{1}{c}{0.907 (0.861, 0.954)} & \multicolumn{1}{c}{0.897 (0.852, 0.943)} & \multicolumn{1}{c}{0.925 (0.882, 0.971)} & \multicolumn{1}{c}{0.904 (0.865, 0.948)} & \multicolumn{1}{c}{0.922 (0.880, 0.967)} & \multicolumn{1}{c}{0.901 (0.859, 0.942)} \\  \multicolumn{1}{c}{Type: OTR} & \multicolumn{1}{c}{1.071 (0.994, 1.151)} & \multicolumn{1}{c}{1.094 (1.022, 1.174)} & \multicolumn{1}{c}{1.053 (0.981, 1.131)} & \multicolumn{1}{c}{1.064 (0.994, 1.140)} & \multicolumn{1}{c}{1.067 (0.990, 1.144)} & \multicolumn{1}{c}{1.106 (1.030, 1.182)} \\  \multicolumn{1}{c}{Type: REG} & \multicolumn{1}{c}{1.003 (0.957, 1.045)} & \multicolumn{1}{c}{1.012 (0.969, 1.057)} & \multicolumn{1}{c}{0.971 (0.928, 1.015)} & \multicolumn{1}{c}{0.994 (0.950, 1.037)} & \multicolumn{1}{c}{0.973 (0.932, 1.016)} & \multicolumn{1}{c}{0.984 (0.943, 1.028)} \\  \multicolumn{1}{c}{Fit statistics: } & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{sample size} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} \\  \multicolumn{1}{c}{elpd\_loo} & \multicolumn{1}{c}{$-39985.2$ (236.5)} & \multicolumn{1}{c}{$-39770.2$ (233.5)} & \multicolumn{1}{c}{$-40792.7$ (238.9)} & \multicolumn{1}{c}{$-40315.5$ (237.2)} & \multicolumn{1}{c}{$-40710.1$ (237.8)} & \multicolumn{1}{c}{$-40503.2$ (239.4)} \\  \multicolumn{1}{c}{p\_loo} & \multicolumn{1}{c}{18.1 (1.1)} & \multicolumn{1}{c}{30 (2.4)} & \multicolumn{1}{c}{19.8 (1.9)} & \multicolumn{1}{c}{18.2 (1.2)} & \multicolumn{1}{c}{15.9 (0.8)} & \multicolumn{1}{c}{16.1 (1)} \\  \multicolumn{1}{c}{looic} & \multicolumn{1}{c}{79970.4 (472.9)} & \multicolumn{1}{c}{79540.5 (467.1)} & \multicolumn{1}{c}{81585.4 (477.8)} & \multicolumn{1}{c}{80631 (474.5)} & \multicolumn{1}{c}{81420.1 (475.7)} & \multicolumn{1}{c}{81006.5 (478.7)} \\  \hline \\[-1.8ex]  \multicolumn{7}{l}{The SCEs were measured as the number of events per 10,000 miles driven. IRRs and associated 95\% credible intervals were reported.} \\  \end{tabular}}  \end{table} 
```




```{r}
pacman::p_load(purrr)
sub_files = list.files("fit", full.names = TRUE, pattern = ".{3}00.{3}.rds")
driver_comb = list.files("fit", pattern = ".{3}00.{3}.rds") %>% 
  gsub(".rds", "", .) %>% 
  gsub("00", "-", .)

fit_list = list()
for (i in seq_along(sub_files)) {
  fit_list[[i]] = readRDS(sub_files[i]) %>% 
  .[[2]] %>% 
  getfit()
}

tab_fit1 = fit_list %>% 
  purrr::reduce(full_join, by = "variables") %>% 
  magrittr::set_colnames(c("variables", driver_comb)) %>%
  arrange(match(variables, 
                c("(Intercept)", "sce_N", "sce_HW", "sce_HB", "sce_RS", "sce_CM",
                  "age", "ping_speed", "genderM", "genderU"))) %>% 
  mutate(variables = 
           recode(variables,
                  "sce_HW" = "Headways", 
                  "sce_HB" = "Hard brakes", 
                  "sce_RS" = "Rolling stability", 
                  "sce_CM" = "Collision mitigation",
                  "age" = "Age",
                  "ping_speed" = "Mean speed",
                  "genderM" = "Gender: male",
                  "genderU" = "Gender: unknown",
                  "bus_unitJBI00" = "Business unit: ITM", 
                  "bus_unitVAN00" = "Businees unit: FIM", 
                  "d_typeOTR" = "Type: OTR", 
                  "d_typeREG" = "Type: REG", 
                  " Intercept " = "(Intercept)")) %>% 
  add_row(variables = "Fit statistics: ") 
names(tab_fit1) %<>% 
  stringr::str_replace_all(., "JBI", "ITM") %>%
  stringr::str_replace_all(., "VAN", "FIM")

loo_list = list()
for (i in seq_along(sub_files)) {
  loo_list[[i]] = readRDS(sub_files[i]) %>% 
  .[[8]] %>% 
  getloo()
}

tab_loo1 = data.frame(c("sample size", "elpd_loo", "p_loo", "looic")) %>% 
  cbind(loo_list[[1]]) %>% 
  cbind(loo_list[[2]]) %>%
  cbind(loo_list[[3]]) %>%
  cbind(loo_list[[4]]) %>%
  cbind(loo_list[[5]]) %>%
  cbind(loo_list[[6]]) %>%
  cbind(loo_list[[7]]) %>%
  magrittr::set_colnames(names(tab_fit1))
```

```{r results='asis', eval=FALSE}
  capture.output({
    stargazer::stargazer(rbind(tab_fit1, tab_loo1), 
                       summary=FALSE, rownames=FALSE,
                       align=TRUE, float = TRUE, table.placement = '!htbp',
                       title = "Bayesian NB regressions with the rate of SCEs predicting crashes, stratified by business units and driver types",
                       font.size = "small",
                       single.row=FALSE, 
                       header=FALSE,
                       notes="The SCEs were measured as the number of events per 10,000 miles driven. IRR and associated 95\\% credible intervals were reported.",
                       label="tab:stratified")
  }) %>% 
  gsub("\\begin{tabular}","\\resizebox{0.8\\paperheight}{!}{\\begin{tabular}", ., fixed=T) %>% 
  gsub("\\end{tabular}","\\end{tabular}}", ., fixed=T) %>% 
  gsub("10000","1.000", ., fixed=T) %>% 
  cat()
```

```{=latex}
 \begin{table}[!htbp] \centering    \caption{Bayesian NB regressions with the rate of SCEs predicting crashes, stratified by business units and driver types}    \label{tab:stratified}  \small  \resizebox{0.8\paperheight}{!}{\begin{tabular}{@{\extracolsep{5pt}} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} }  \\[-1.8ex]\hline  \hline \\[-1.8ex]  \multicolumn{1}{c}{variables} & \multicolumn{1}{c}{DCS-LOC} & \multicolumn{1}{c}{DCS-OTR} & \multicolumn{1}{c}{DCS-REG} & \multicolumn{1}{c}{ITM-LOC} & \multicolumn{1}{c}{ITM-REG} & \multicolumn{1}{c}{FIM-OTR} & \multicolumn{1}{c}{FIM-REG} \\  \hline \\[-1.8ex]  \multicolumn{1}{c}{(Intercept)} & \multicolumn{1}{c}{0.055 (0.040, 0.076)} & \multicolumn{1}{c}{0.015 (0.008, 0.027)} & \multicolumn{1}{c}{0.062 (0.046, 0.084)} & \multicolumn{1}{c}{0.026 (0.020, 0.033)} & \multicolumn{1}{c}{0.021 (0.013, 0.033)} & \multicolumn{1}{c}{0.047 (0.021, 0.102)} & \multicolumn{1}{c}{0.033 (0.022, 0.049)} \\  \multicolumn{1}{c}{Headways} & \multicolumn{1}{c}{1.026 (1.011, 1.042)} & \multicolumn{1}{c}{1.001 (0.993, 1.010)} & \multicolumn{1}{c}{1.048 (1.032, 1.067)} & \multicolumn{1}{c}{1.026 (1.012, 1.042)} & \multicolumn{1}{c}{1.060 (1.038, 1.082)} & \multicolumn{1}{c}{1.082 (1.020, 1.149)} & \multicolumn{1}{c}{1.050 (1.031, 1.068)} \\  \multicolumn{1}{c}{Hard brakes} & \multicolumn{1}{c}{1.069 (1.057, 1.080)} & \multicolumn{1}{c}{1.241 (1.194, 1.293)} & \multicolumn{1}{c}{1.163 (1.140, 1.188)} & \multicolumn{1}{c}{1.047 (1.040, 1.054)} & \multicolumn{1}{c}{1.114 (1.093, 1.138)} & \multicolumn{1}{c}{1.086 (1.049, 1.131)} & \multicolumn{1}{c}{1.183 (1.154, 1.211)} \\  \multicolumn{1}{c}{Rolling stability} & \multicolumn{1}{c}{1.528 (1.367, 1.733)} & \multicolumn{1}{c}{1.648 (1.269, 2.229)} & \multicolumn{1}{c}{1.676 (1.467, 1.951)} & \multicolumn{1}{c}{1.419 (1.284, 1.578)} & \multicolumn{1}{c}{2.477 (1.590, 3.717)} & \multicolumn{1}{c}{4.320 (2.210, 9.522)} & \multicolumn{1}{c}{1.175 (1.039, 1.369)} \\  \multicolumn{1}{c}{Collision mitigation} & \multicolumn{1}{c}{1.163 (1.127, 1.203)} & \multicolumn{1}{c}{1.318 (1.132, 1.540)} & \multicolumn{1}{c}{1.362 (1.292, 1.440)} & \multicolumn{1}{c}{1.212 (1.174, 1.252)} & \multicolumn{1}{c}{1.577 (1.422, 1.766)} & \multicolumn{1}{c}{1.134 (0.952, 1.353)} & \multicolumn{1}{c}{1.170 (1.121, 1.234)} \\  \multicolumn{1}{c}{Age} & \multicolumn{1}{c}{0.992 (0.989, 0.995)} & \multicolumn{1}{c}{0.988 (0.982, 0.993)} & \multicolumn{1}{c}{0.993 (0.990, 0.996)} & \multicolumn{1}{c}{0.995 (0.993, 0.998)} & \multicolumn{1}{c}{0.986 (0.982, 0.990)} & \multicolumn{1}{c}{0.999 (0.989, 1.010)} & \multicolumn{1}{c}{0.997 (0.993, 1.000)} \\  \multicolumn{1}{c}{Mean speed} & \multicolumn{1}{c}{0.976 (0.970, 0.983)} & \multicolumn{1}{c}{1.016 (1.005, 1.027)} & \multicolumn{1}{c}{0.968 (0.962, 0.974)} & \multicolumn{1}{c}{0.994 (0.987, 1.000)} & \multicolumn{1}{c}{1.000 (0.988, 1.012)} & \multicolumn{1}{c}{0.973 (0.958, 0.988)} & \multicolumn{1}{c}{0.983 (0.973, 0.994)} \\  \multicolumn{1}{c}{Gender: male} & \multicolumn{1}{c}{0.883 (0.702, 1.083)} & \multicolumn{1}{c}{0.868 (0.631, 1.227)} & \multicolumn{1}{c}{0.844 (0.716, 0.997)} & \multicolumn{1}{c}{0.749 (0.650, 0.862)} & \multicolumn{1}{c}{0.841 (0.691, 1.029)} & \multicolumn{1}{c}{0.675 (0.433, 1.027)} & \multicolumn{1}{c}{0.751 (0.634, 0.893)} \\  \multicolumn{1}{c}{Gender: unknown} & \multicolumn{1}{c}{1.065 (0.589, 1.908)} & \multicolumn{1}{c}{1.378 (0.706, 2.617)} & \multicolumn{1}{c}{0.576 (0.325, 0.980)} & \multicolumn{1}{c}{1.287 (0.774, 2.079)} & \multicolumn{1}{c}{0.194 (0.044, 0.626)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{0.816 (0.571, 1.158)} \\  \multicolumn{1}{c}{Fit statistics: } & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{sample size} & \multicolumn{1}{c}{6950} & \multicolumn{1}{c}{1797} & \multicolumn{1}{c}{7405} & \multicolumn{1}{c}{6429} & \multicolumn{1}{c}{3339} & \multicolumn{1}{c}{943} & \multicolumn{1}{c}{4963} \\  \multicolumn{1}{c}{elpd\_loo} & \multicolumn{1}{c}{$-9300.8$ (125.3)} & \multicolumn{1}{c}{$-2416.9$ (52.2)} & \multicolumn{1}{c}{$-9799.1$ (112.1)} & \multicolumn{1}{c}{$-7624.2$ (90.8)} & \multicolumn{1}{c}{$-3912.6$ (70.5)} & \multicolumn{1}{c}{$-1139.8$ (40)} & \multicolumn{1}{c}{$-5293.9$ (85.4)} \\  \multicolumn{1}{c}{p\_loo} & \multicolumn{1}{c}{30.6 (5)} & \multicolumn{1}{c}{14.3 (2.5)} & \multicolumn{1}{c}{20.4 (2.6)} & \multicolumn{1}{c}{17.4 (2.3)} & \multicolumn{1}{c}{13.9 (1.7)} & \multicolumn{1}{c}{11 (1.6)} & \multicolumn{1}{c}{19.4 (2.9)} \\  \multicolumn{1}{c}{looic} & \multicolumn{1}{c}{18601.6 (250.6)} & \multicolumn{1}{c}{4833.8 (104.5)} & \multicolumn{1}{c}{19598.1 (224.2)} & \multicolumn{1}{c}{15248.3 (181.6)} & \multicolumn{1}{c}{7825.2 (141)} & \multicolumn{1}{c}{2279.5 (79.9)} & \multicolumn{1}{c}{10587.7 (170.8)} \\  \hline \\[-1.8ex]  \multicolumn{8}{l}{The SCEs were measured as the number of events per 10,000 miles driven. IRR and associated 95\% credible intervals were reported.} \\  \end{tabular}}  \end{table} 
```


\elandscape

Bayesian NB models for injuries and fatalities
----------------------------------------------
Table \@ref(tab:injuries) below presents the results of Bayesian NB models predicting the number of injuries and the number of fatalities respectively. Compared with the models for crashes, the result for injuries and fatalities are less conclusive since the number of injuries and fatalities is small. One unit increase in the number of any type of SCEs per 10,000 miles was associated with 8.7% (95% CI: 4.8%-13.6%) increase in the number of injuries per mile. When stratified into four different types of SCEs, all 95% CIs of IRRs included one, which indicated weak evidence for modeling injuries or fatalities, although the posterior means were positive. In the two models using the number of fatalities as the outcome variable (column 4 and 5), all 95% CIs of IRRs included one and the CIs were very wide, which suggested insufficient sample size in the number of fatalities to yield statistically significant results.

```{r}
inj = readRDS("fit/injury_fatality_fit.rds")
inj = readRDS("fit/injury_fatality_fit.rds")

tab_fit = getfit(inj[[1]], "Injuries: pooled") %>% 
  full_join(getfit(inj[[2]], "Injuries: four SCEs")) %>% 
  full_join(getfit(inj[[3]], "Fatalities: pooled")) %>% 
  full_join(getfit(inj[[4]], "Fatalities: four SCEs")) %>% 
  mutate(variables = gsub("^b_", "", variables)) %>% 
  filter(!(variables %in% c("shape", "lp__"))) %>% 
  arrange(match(variables, 
                c(" Intercept ", "sce_N", "sce_HW", "sce_HB", "sce_RS", "sce_CM",
                  "age", "ping_speed", "genderM", "genderU", 
                  "bus_unitJBI00", "bus_unitVAN00", 
                  "d_typeOTR", "d_typeREG"))) %>% 
  mutate(variables = 
           recode(variables,
                  "sce_N" = "All SCEs",
                  "sce_HW" = "Headways", 
                  "sce_HB" = "Hard brakes", 
                  "sce_RS" = "Rolling stability", 
                  "sce_CM" = "Collision mitigation",
                  "age" = "Age",
                  "ping_speed" = "Mean speed",
                  "genderM" = "Gender: male",
                  "genderU" = "Gender: unknown",
                  "bus_unitJBI00" = "Business unit: ITM", 
                  "bus_unitVAN00" = "Businees unit: FIM", 
                  "d_typeOTR" = "Type: OTR", 
                  "d_typeREG" = "Type: REG", 
                  " Intercept " = "(Intercept)")) %>% 
  add_row(variables = "Fit statistics: ")

tab_loo = data.frame(c("sample size", "elpd_loo", "p_loo", "looic")) %>% 
  cbind(getloo(inj[[5]])) %>% 
  cbind(getloo(inj[[6]])) %>% 
  cbind(getloo(inj[[7]])) %>% 
  cbind(getloo(inj[[8]])) %>% 
  magrittr::set_colnames(names(tab_fit))
```

```{r results='asis', eval=FALSE}
capture.output({
  stargazer::stargazer(rbind(tab_fit, tab_loo), 
                       summary=FALSE, rownames=FALSE,
                       align=TRUE,  float = TRUE, table.placement = '!htbp',
                       title = "Bayesian NB regressions with the rate of SCEs predicting crashes",
                       font.size = "small",
                       single.row=FALSE, header=FALSE,
                       notes="The SCEs were measured as the number of events per 10,000 miles driven. IRR and associated 95\\% credible intervals were reported.",
                       label="tab:injuries")
  }) %>% 
  gsub("\\begin{tabular}","\\resizebox{\\textwidth}{!}{\\begin{tabular}", ., fixed=T) %>% 
  gsub("\\end{tabular}","\\end{tabular}}", ., fixed=T) %>% 
  cat()
```

```{=latex}
 \begin{table}[!htbp] \centering    \caption{Bayesian NB regressions with the rate of SCEs predicting crashes}    \label{tab:injuries}  \small  \resizebox{\textwidth}{!}{\begin{tabular}{@{\extracolsep{5pt}} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} }  \\[-1.8ex]\hline  \hline \\[-1.8ex]  \multicolumn{1}{c}{variables} & \multicolumn{1}{c}{Injuries: pooled} & \multicolumn{1}{c}{Injuries: four SCEs} & \multicolumn{1}{c}{Fatalities: pooled} & \multicolumn{1}{c}{Fatalities: four SCEs} \\  \hline \\[-1.8ex]  \multicolumn{1}{c}{All SCEs} & \multicolumn{1}{c}{1.087 (1.048, 1.136)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{0.973 (0.791, 1.149)} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{Headways} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.061 (0.961, 1.181)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{0.955 (0.592, 1.478)} \\  \multicolumn{1}{c}{Hard brakes} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.080 (0.995, 1.177)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{0.957 (0.652, 1.387)} \\  \multicolumn{1}{c}{Rolling stability} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.773 (0.684, 5.439)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.631 (0.043, 102.782)} \\  \multicolumn{1}{c}{Collision mitigation} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{1.174 (0.987, 1.535)} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{0.866 (0.200, 3.632)} \\  \multicolumn{1}{c}{Age} & \multicolumn{1}{c}{0.987 (0.970, 1.004)} & \multicolumn{1}{c}{0.986 (0.969, 1.004)} & \multicolumn{1}{c}{0.966 (0.912, 1.020)} & \multicolumn{1}{c}{0.965 (0.906, 1.030)} \\  \multicolumn{1}{c}{Mean speed} & \multicolumn{1}{c}{0.967 (0.929, 1.007)} & \multicolumn{1}{c}{0.970 (0.931, 1.009)} & \multicolumn{1}{c}{0.915 (0.797, 1.049)} & \multicolumn{1}{c}{0.910 (0.778, 1.050)} \\  \multicolumn{1}{c}{Gender: male} & \multicolumn{1}{c}{0.825 (0.301, 2.149)} & \multicolumn{1}{c}{0.800 (0.298, 2.176)} & \multicolumn{1}{c}{1.770 (0.074, 54.444)} & \multicolumn{1}{c}{1.953 (0.062, 80.045)} \\  \multicolumn{1}{c}{Gender: unknown} & \multicolumn{1}{c}{1.022 (0.094, 8.499)} & \multicolumn{1}{c}{0.993 (0.092, 9.338)} & \multicolumn{1}{c}{0.093 (0.000, 76.248)} & \multicolumn{1}{c}{0.093 (0.000, 115.564)} \\  \multicolumn{1}{c}{Business unit: ITM} & \multicolumn{1}{c}{0.459 (0.265, 0.788)} & \multicolumn{1}{c}{0.467 (0.280, 0.789)} & \multicolumn{1}{c}{0.354 (0.068, 1.573)} & \multicolumn{1}{c}{0.341 (0.044, 2.057)} \\  \multicolumn{1}{c}{Businees unit: FIM} & \multicolumn{1}{c}{0.710 (0.352, 1.420)} & \multicolumn{1}{c}{0.675 (0.330, 1.321)} & \multicolumn{1}{c}{1.576 (0.209, 10.438)} & \multicolumn{1}{c}{1.536 (0.140, 13.475)} \\  \multicolumn{1}{c}{Type: OTR} & \multicolumn{1}{c}{0.785 (0.321, 1.942)} & \multicolumn{1}{c}{0.801 (0.306, 1.955)} & \multicolumn{1}{c}{0.410 (0.022, 5.402)} & \multicolumn{1}{c}{0.388 (0.014, 6.205)} \\  \multicolumn{1}{c}{Type: REG} & \multicolumn{1}{c}{0.472 (0.265, 0.821)} & \multicolumn{1}{c}{0.463 (0.263, 0.820)} & \multicolumn{1}{c}{0.389 (0.064, 1.970)} & \multicolumn{1}{c}{0.379 (0.050, 2.214)} \\  \multicolumn{1}{c}{Intercept} & \multicolumn{1}{c}{0.013 (0.002, 0.070)} & \multicolumn{1}{c}{0.012 (0.002, 0.064)} & \multicolumn{1}{c}{0.008 (0.000, 1.855)} & \multicolumn{1}{c}{0.011 (0.000, 5.179)} \\  \multicolumn{1}{c}{Fit statistics: } & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} \\  \multicolumn{1}{c}{sample size} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} & \multicolumn{1}{c}{31828} \\  
 \multicolumn{1}{c}{elpd\_loo} & \multicolumn{1}{c}{$-1134.5$ (80.8)} & \multicolumn{1}{c}{$-1137.3$ (81.1)} & \multicolumn{1}{c}{$-182.4$ (37.9)} & \multicolumn{1}{c}{$-182.4$ (37.9)} \\  \multicolumn{1}{c}{p\_loo} & \multicolumn{1}{c}{13.9 (3.6)} & \multicolumn{1}{c}{16.4 (4)} & \multicolumn{1}{c}{11.3 (3.2)} & \multicolumn{1}{c}{11.3 (3.2)} \\  \multicolumn{1}{c}{looic} & \multicolumn{1}{c}{2269.1 (161.5)} & \multicolumn{1}{c}{2274.6 (162.1)} & \multicolumn{1}{c}{364.7 (75.7)} & \multicolumn{1}{c}{364.7 (75.7)} \\  \hline \\[-1.8ex]  \multicolumn{5}{l}{The SCEs were measured as the number of events per 10,000 miles driven. IRR and associated 95\% credible intervals were reported.} \\  \end{tabular}}  \end{table} 
```



```{r plotcrashSCE, eval=F, out.width='\\textwidth', fig.cap='crude rates of crashes and SCEs'}
knitr::include_graphics("figs/crash_SCE.jpeg")
```

```{r plotcrashCOV, eval=F, out.width='\\textwidth', fig.cap='crude rates of crashes and other variables'}
knitr::include_graphics("figs/other_covariate.jpeg")
```

Diagnostics statistics and model selection
------------------------------------------
All the models have Pareto $k$ diagnostic statistics of less than 0.7, which suggests no signal for model misspecification. The estimated effective number of parameters (`p_loo` in Tables \@ref(tab:pooled), \@ref(tab:stratified), \@ref(tab:injuries)), which were similar to the total number of parameters in the models. These two results suggest NB models were reasonably specified models given the large number of observations in this study [@vehtari2017practical; @vehtari2015pareto]. The LOOIC in the tables can be used to compare different models, with lower values indicating better models. In Table \@ref(tab:pooled), the "Four SCEs" model has the lowest LOOIC (79,540.5) among the six models, although the standard errors in the bracket suggested that the "Four SCEs" model was not significantly better than the "Pooled" model.

In addition, we also checked the model fit by comparing the observed data to 100 replicated data sets generated from the parameter posterior distributions [@gelman2006data]. For each simulated data set, we computed the proportion of zero crashes and compared them to the observed proportion in the original data. Figure \@ref(fig:loopooled) and \@ref(fig:loostratified) below present the posterior predictive check for models in Table \@ref(tab:pooled) and \@ref(tab:stratified). The black solid vertical lines are the observed proportion of zero crashes in observed data, while the light blue histograms show the distribution of proportion of zero crashes in the 100 simulated data sets generated from the parameter posterior distributions. Although the observed proportion was away from the distribution of proportions in simulated data sets in Figure \@ref(fig:loopooled), the difference between the observed proportion and the center of simulated distribution was less than 1.5%. By contrast, in Figure \@ref(fig:loostratified) below, the observed proportion of zero crashes located almost exactly at the center of the simulated distributions when stratified by different business units and driver types, which suggested that stratified models in Table \@ref(tab:stratified) have better prediction accuracy and model fit than non-stratified models.
  

```{r loopooled, out.width='\\textwidth', fig.cap='PPC with zero count test statistic for Bayesian negative binomial models for all drivers'}
knitr::include_graphics("figs/loo_pooled.pdf")
```

```{r loostratified, out.width='\\textwidth', fig.cap='PPC with zero count test statistic for Bayesian negative binomial models, stratified by business unit and driver types'}
knitr::include_graphics("figs/loo_stratified_limit_x.pdf")
```

Discussion
==========
In line with previous studies on the association between crashes and SCE in NDS [@guo2010near; @gordon2011analysis; @simons2012elevated; @wu2012crashes; @guo2013individual; @pande2017preliminary; @gitelman2018exploring], this study provides statistically significant and robust evidence that there is positive association between SCEs and crashes among commercial truck drivers in the United States. In addition, we have quantified the strength of this association.

The current study contributes to the existing literature in three aspects. First, this paper overcome the small sample size issues in previous crashes and crash surrogates papers, which typically include no more than 100 drivers or vehicles [@guo2010near; @gitelman2018exploring]. Our study included 31,690 commercial truck drivers, and the large sample size allows us to investigate the association between four different types of SCEs and crashes, as well as stratified analyses across business units and driver types. Second, commercial trucks are the major causes of catastrophic accidents and transportation risk, but evidence on the association between crashes and crash surrogates among truck drivers is scarce. Our study gives insights to this less studied field using a nationwide large-scale sample. Third, this paper explored the association between SCEs and human injuries, which is investigated in previous papers yet important question. We found that as the number of SCEs per 10,000 miles increase by one unit, the number of injuries per mile will increase by 8.7% (95% CI: 4.8%-13.6%).

Among the four types of SCEs studied in this paper, the most frequent one is hard brakes (n = 231,101), followed by headways (n = 184,773), collision mitigation (n = 55,345), and rolling stability (n = 9,112). The number of hard brakes is around 25 times higher than that of rolling stability. The number of hard brakes and headways are greater than collision mitigation and rolling stability. In statistical analyses, we did not find that hard brakes and headways were over-defined. One unit increase in the number of hard brakes or headways per 10,000 miles were consistently associated with increase in crashes, and this association still holds when stratified by business units and driver types. The IRRs of hard brakes and headways were smaller than those of collision mitigation and rolling stability, which could be explained by the relatively high frequencies.

Although our study shows a positive association between SCEs and crashes, as well as injuries, we cannot conclude that the second assumption in Heinrich's Triangle is true, i.e., the frequency of severe events can diminish as the frequency of less severe events decreases [@guo2010near]. This study used a cross-sectional observatory design and no experiments were involved. Therefore, we should not make any causal statements on this association. Exploring the causal relationship between SCEs and crashes requires well-designed experiments or state-of-start causal inference models for observatory data, which is beyond the scope of this study and could be a direction that future studies can focus on.

Our results are based on truck driving data from a single trucking company, but we argue that the generalizability of the results to other trucking companies is high. First, Company A is a leading trucking and transportation company in the United States, and their business divisions, routing, and scheduling are not particularly special compared to other trucking companies. Second, the commercial trucking industry has a high turn-over rate [@johnson2010long], which means the truck drivers actively switch between companies. Therefore, different trucking companies share a fair amount of drivers and are generally similar regarding drivers. Third, a substantial number of drivers in each of the three business units and three driver types have been included in our study. The number of truck drivers involved is at least 30 times as high as those in other relevant studies, and the traveling pings cover the entire country and most of the major roads. Nonetheless, we still suggest the researchers always investigate the relationship between SCEs and crashes or injuries prior to applying SCEs as surrogates of crashes in risk prediction.

This study has several limitations. First, since the exact time of the crashes were not recorded, we are not able to find out which and how many SCEs directly cause crashes, which is a crucial question in Heinrich's Triangle. Second, although we have a relatively large number of drivers and high mileage driven, the number of injuries or fatalities is not sufficiently large for stratified analyses. The statistical evidence on the number of injuries is strong only when we combine four types of SCEs, while the evidence on fatalities is either of the two models is not strong given the small number of fatalities. Third, we do not have data on traffic or weather variables, which are important predictors of crashes. Fourth, since the crash data in this study were reported by the drivers, it is likely that the drivers were underreporting crashes, especially for non-injury or non-fatality injuries.

<!--
- The drivers may switch between business units and driver types.
- The number of crashes may be underreported.
-->

Summary and conclusion
======================
Based on routinely collected NDS and kinematic data from 31,690 truck drivers in a large commercial trucking company, this study investigated the association between SCEs (headways, hard brakes, collision mitigation, and rolling stability) and crashes, injuries, and fatalities using Bayesian negative binomial regression models. We found that one unit increase in the number of any type of SCEs per 10,000 miles was associated with 8.4% (95% CI: 8-8.8%) increase in SCEs per mile and 8.7% (95% CI: 4.8%-13.6%) increase in the number of injuries per mile. The increase was different in different types of SCEs: 3.3% (95% CI: 2.6-4%) for headways, 8.1% (95% CI: 7.5-8.7%) for hard brakes, 50.4% (95% CI: 41.4-60%) for rolling stability, and 22.2% (95% CI: 19.8-24.5%) for collision mitigation. The results are consistent when stratified by different business units and driver types. This work provides statistically strong and robust evidence that SCEs are positively associated with crashes and injuries among commercial truck drivers.

Supplementary materials
=======================
In an effort to promote open and reproducible research, we have released our source code and aggregated data at a website hosted by GitHub Pages. Interested reader can visit it at [https://caimiao0714.github.io/Github-SCE-crash/](https://caimiao0714.github.io/Github-SCE-crash/). The original ping data include sensitive latitude and longitude information and cannot be made open. The website contains the following information:

A) Ping data and trip aggregation
    - Ping data demonstration
    - Aggregating ping data into trips
    - Ping and trip data visualization
B) Statistical modeling
    - Aggregated driver-level data
    - Bayesian Negative binomial regression using `rstanarm`
    - Model comparison and diagnostics using `loo`


Acknowledgment {-}
===============
This work was supported in part by: the National Science Foundation (CMMI-1635927 and CMMI-1634992); the Ohio Supercomputer Center (PMIU0138 and PMIU0162); the American Society of Safety Professionals (ASSP) Foundation; the University of Cincinnati Education and Research Center Pilot Research Project Training Program; the Transportation Informatics Tier I University Transportation Center (TransInfo); a Google Cloud Platform research grant for data management; and a Dark Sky grant for extended API access (i.e., they increased the number of allowable queries per day).

References {#references .unnumbered}
==========

\everypar{\hangafter=1 \setlength{\hangindent}{3em}}{\par}
\setlength\parskip{0.3em}
\setlength\parindent{0pt}



